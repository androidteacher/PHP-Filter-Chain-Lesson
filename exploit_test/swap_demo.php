<?php
// exploit_test/swap_demo.php
$file = '/flag/flag.txt';
echo "[*] Reading $file directly:\n";
echo "    " . trim(file_get_contents($file)) . "\n";

echo "\n[*] Reading with Filter (UTF-16LE <-> UTF-16BE):\n";
echo "    Filter: convert.iconv.UTF-16LE.UTF-16BE\n";

// This swaps bytes pairwise: 1,2 becomes 2,1. 3,4 becomes 4,3.
// 'flag' (66 6C 61 67) becomes (6C 66 67 61) -> 'lfga'
$filter = "convert.iconv.UTF-16LE.UTF-16BE";
$swapped = file_get_contents("php://filter/read=$filter/resource=$file");

echo "    Result: " . trim($swapped) . "\n";
?>